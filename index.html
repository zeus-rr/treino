<!doctype html>
<html lang="pt-BR" class="dark">
<head>
    <link rel="icon" href="https://zeus-rr.github.io/treino/icon.png">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title id="pageTitle">SISTEMA DE TREINO PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', 
            theme: { 
                extend: { 
                    colors: { 
                        'pink-hot': 'var(--main-color, #FF1493)', 
                        'bg-dark': '#0b0f1a' 
                    } 
                } 
            }
        }
    </script>
    <style>
        :root { --main-color: #FF1493; }
        .is-conjugated { margin-bottom: -1rem !important; border-bottom-left-radius: 0 !important; border-bottom-right-radius: 0 !important; border-bottom: 2px dashed var(--main-color) !important; z-index: 10; }
        .is-conjugated + .workout-item { border-top-left-radius: 0 !important; border-top-right-radius: 0 !important; }
        .is-student-mode .admin-ui, .is-student-mode .edit-btn, .is-student-mode .drag-handle { display: none !important; }
        
        .serie-dot { width: 28px; height: 28px; border: 2px solid var(--main-color); border-radius: 50%; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        .serie-dot.checked { background-color: var(--main-color); color: white; transform: scale(1.1); box-shadow: 0 0 10px var(--main-color); }
        
        .progress-bar-container { position: fixed; top: 0; left: 0; width: 100%; height: 5px; background: rgba(255,20,147,0.1); z-index: 1000; }
        #progressFill { height: 100%; background: var(--main-color); width: 0%; transition: width 0.3s ease; }

        .pink-bold { color: var(--main-color) !important; font-weight: 900 !important; }
        .btn-whatsapp-float { position: fixed; bottom: 20px; right: 20px; background-color: #25d366; color: white; padding: 10px 20px; border-radius: 50px; font-weight: 800; text-transform: uppercase; font-size: 11px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); display: flex; align-items: center; gap: 10px; z-index: 1000; border: 2px solid white; text-decoration: none; }
        .btn-whatsapp-float img { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; }
        
        .category-content { display: none; }
        .category-content.active { display: block; }
        .drag-handle { cursor: grab; padding-right: 10px; color: #64748b; font-size: 1.2rem; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--main-color); border-radius: 10px; }

        .student-header-pdf { display: flex; flex-direction: column; align-items: center; margin-bottom: 2rem; text-align: center; }
        .student-photo-large { width: 130px; height: 130px; border-radius: 50%; border: 4px solid var(--main-color); object-fit: cover; margin-bottom: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }

        /* Loader Animation */
        .loader { border: 2px solid #f3f3f3; border-top: 2px solid var(--main-color); border-radius: 50%; width: 12px; height: 12px; animation: spin 1s linear infinite; display: inline-block; margin-right: 8px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .btn-loading { opacity: 0.7; pointer-events: none; }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; color: black !important; }
            .admin-ui { display: none !important; }
        }
    </style>
</head>
<body class="bg-slate-100 dark:bg-[#0b0f1a] text-slate-800 dark:text-slate-100 font-sans min-h-screen">

    <div id="progressContainer" class="progress-bar-container hidden"><div id="progressFill"></div></div>

    <a id="waFloat" href="#" target="_blank" class="btn-whatsapp-float no-print">
        <img id="waPhoto" src="https://zeus-rr.github.io/treino/icon.png">
        <span id="waText">D√∫vida Professor</span>
    </a>

    <header class="p-4 border-b border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <img id="displayImgProf" src="https://zeus-rr.github.io/treino/icon.png" class="w-10 h-10 rounded-full border-2 border-pink-hot object-cover">
                <h1 id="brandName" class="text-xl italic uppercase tracking-tighter pink-bold">SISTEMA DE TREINO</h1>
            </div>
            <div class="flex items-center gap-3">
                <div id="saveStatus" class="text-[9px] font-bold bg-amber-500/20 text-amber-500 px-2 py-1 rounded admin-ui uppercase">Pendente</div>
                <button onclick="toggleTheme()" class="p-2 rounded-xl bg-slate-100 dark:bg-slate-800 border no-print">üåì</button>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-6 w-full">
        <aside class="lg:col-span-4 space-y-4 admin-ui">
            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-xl border border-pink-hot/20">
                <h3 class="text-[10px] font-black uppercase mb-4 text-pink-hot tracking-widest">Configura√ß√µes do Professor</h3>
                <div class="space-y-3">
                    <input type="text" id="confName" oninput="updateConfigs()" placeholder="Nome do Professor" class="w-full bg-slate-100 dark:bg-slate-800 p-2 rounded-lg text-sm font-bold outline-none border-b-2 border-pink-hot">
                    <input type="text" id="confPhone" oninput="updateConfigs()" placeholder="WhatsApp (55...)" class="w-full bg-slate-100 dark:bg-slate-800 p-2 rounded-lg text-sm font-bold outline-none">
                    
                    <div class="space-y-1">
                        <label class="text-[9px] font-black uppercase opacity-60 ml-1">Foto do Professor (Anexar)</label>
                        <input type="file" id="fileProf" accept="image/*" onchange="processFile(this, 'prof')" class="w-full bg-slate-100 dark:bg-slate-800 p-2 rounded-lg text-[10px] font-bold outline-none border-b border-pink-hot/30">
                    </div>
                    
                    <div class="flex items-center justify-between p-2 bg-slate-100 dark:bg-slate-800 rounded-lg mt-2">
                        <label class="text-[10px] font-black uppercase opacity-60">Cor do Tema</label>
                        <input type="color" id="themeColor" oninput="updateConfigs()" class="h-8 w-12 bg-transparent cursor-pointer">
                    </div>
                </div>
            </div>

            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800">
                <h3 class="text-[10px] font-black uppercase mb-4 text-pink-hot tracking-widest">Dados do Aluno</h3>
                <input type="text" id="studentName" oninput="updateHeader()" placeholder="Nome do Aluno" class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl mb-3 font-bold outline-none">
                
                <div class="space-y-1 mb-3">
                    <label class="text-[9px] font-black uppercase opacity-60 ml-1">Foto do Aluno (Anexar)</label>
                    <input type="file" id="fileStudent" accept="image/*" onchange="processFile(this, 'student')" class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl text-[10px] font-bold outline-none border-b-2 border-pink-hot">
                </div>
                
                <select id="daySelector" class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl font-bold text-sm outline-none">
                    <option value="segunda">Segunda-feira</option>
                    <option value="terca">Ter√ßa-feira</option>
                    <option value="quarta">Quarta-feira</option>
                    <option value="quinta">Quinta-feira</option>
                    <option value="sexta">Sexta-feira</option>
                    <option value="sabado">S√°bado</option>
                </select>
            </div>

            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800">
                <h3 class="text-xs font-black uppercase mb-4 text-pink-hot tracking-widest">Biblioteca de Exerc√≠cios</h3>
                <input type="text" id="searchEx" oninput="filterLibrary()" placeholder="Buscar exerc√≠cio..." class="w-full bg-slate-100 dark:bg-slate-800 p-3 rounded-xl mb-4 text-sm outline-none">
                <div id="accordionLib" class="space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar pr-2"></div>
            </div>
            
            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] shadow-xl border border-slate-200 dark:border-slate-800">
                <h3 class="text-[10px] font-black uppercase mb-4 text-pink-hot tracking-widest">Hist√≥rico de Alunos</h3>
                <button onclick="saveToHistory()" class="w-full bg-pink-hot text-white text-[10px] font-black p-3 rounded-xl uppercase mb-4 shadow-lg">üíæ Salvar Treino Atual</button>
                <div id="historyList" class="space-y-2 max-h-48 overflow-y-auto custom-scrollbar"></div>
            </div>
        </aside>

        <section class="lg:col-span-8 space-y-6">
            <div class="flex flex-wrap gap-2 no-print">
                <button id="btnWA" onclick="checkAndExecute(sendWhatsApp)" class="bg-green-600 text-white px-5 py-3 rounded-full font-black text-[10px] uppercase shadow-lg admin-ui">Enviar WhatsApp üì±</button>
                <button id="btnLink" onclick="checkAndExecute(generateLink)" class="bg-pink-hot text-white px-5 py-3 rounded-full font-black text-[10px] uppercase shadow-lg admin-ui">Copiar Link üîó</button>
                <button onclick="clearCurrentWork()" class="bg-red-500/10 text-red-500 px-5 py-3 rounded-full font-black text-[10px] uppercase admin-ui border border-red-500/20">Limpar Tela</button>
                <button onclick="window.print()" class="bg-slate-700 text-white px-5 py-3 rounded-full font-black text-[10px] uppercase shadow-lg">Gerar PDF üìÑ</button>
            </div>

            <div id="studentHeaderTop" class="hidden student-header-pdf"></div>
            <div id="weekDisplay" class="space-y-10"></div>

            <div id="finishArea" class="hidden text-center p-10 bg-white dark:bg-slate-900 rounded-[2rem] border-2 border-dashed border-pink-hot">
                <h2 class="text-2xl font-black text-pink-hot">TREINO CONCLU√çDO! üî•</h2>
                <button onclick="location.reload()" class="mt-4 bg-pink-hot text-white px-6 py-2 rounded-full font-bold text-xs uppercase">Reiniciar</button>
            </div>

            <div class="bg-white dark:bg-slate-900 p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800">
                <h3 class="text-xs font-black uppercase mb-4 text-pink-hot tracking-widest">Observa√ß√µes Gerais</h3>
                <textarea id="generalNotes" oninput="saveDraft(); markUnsaved()" class="w-full bg-slate-100 dark:bg-slate-800 p-4 rounded-xl text-sm outline-none min-h-[100px]" placeholder="Dicas de execu√ß√£o, cardio ou dieta..."></textarea>
            </div>
        </section>
    </main>

    <script>
        const exerciseLibrary = {
            "Peito": ["Supino Reto Barra", "Supino Reto Halteres", "Supino Inclinado Barra", "Supino Inclinado Halteres", "Supino Declinado", "Crucifixo Reto", "Crucifixo Inclinado", "Peck Deck (Voador)", "Crossover Cabo Alto", "Crossover Cabo M√©dio", "Crossover Cabo Baixo", "Flex√£o de Bra√ßos Solo", "Supino M√°quina", "Pullover Halter", "Dips (Paralelas)"],
            "Costas": ["Puxada Frente Aberta", "Puxada Tri√¢ngulo", "Puxada Supinada", "Remada Curvada Barra", "Remada Unilateral (Serrote)", "Remada Baixa Polia", "Remada Cavalinho", "Pulldown Corda", "Barra Fixa", "Levantamento Terra", "Extens√£o Lombar", "Face Pull"],
            "Quadr√≠ceps": ["Agachamento Livre", "Agachamento Hack", "Leg Press 45¬∫", "Leg Press Horizontal", "Cadeira Extensora", "Agachamento B√∫lgaro", "Afundo", "Passada", "Agachamento Sum√¥", "Sissy Squat"],
            "Posterior/Gl√∫teo": ["Stiff", "Mesa Flexora", "Cadeira Flexora", "Eleva√ß√£o P√©lvica", "Cadeira Abdutora", "Cadeira Adutora", "Gl√∫teo no Cabo (Coice)", "RDL"],
            "Ombros": ["Desenvolvimento Militar", "Desenvolvimento Halteres", "Desenvolvimento Arnold", "Eleva√ß√£o Lateral", "Eleva√ß√£o Lateral Cabo", "Eleva√ß√£o Frontal", "Crucifixo Inverso"],
            "B√≠ceps": ["Rosca Direta Barra W", "Rosca Alternada", "Rosca Martelo", "Rosca Scott", "Rosca Concentrada", "Rosca Inclinada 45¬∫", "Rosca Cross Baixo", "Rosca Inversa"],
            "Tr√≠ceps": ["Tr√≠ceps Pulley V", "Tr√≠ceps Corda", "Tr√≠ceps Testa", "Tr√≠ceps Franc√™s", "Mergulho Banco", "Dips Tr√≠ceps", "Tr√≠ceps Coice", "Supino Fechado"],
            "Panturrilha/Core": ["G√™meos em P√©", "G√™meos Sentado", "Abdominal Supra", "Abdominal Infra", "Prancha Isom√©trica", "Abdominal Roda", "V√°cuo"],
            "C√°rdio": ["Corrida Esteira", "Bicicleta", "Corda Naval", "El√≠ptico", "Pular Corda", "Burpees", "Polichinelos"]
        };

        let workoutData = { 
            student: "", photoStudent: "", generalNotes: "", photoProf: "https://zeus-rr.github.io/treino/icon.png",
            profName: "PERSONAL", profPhone: "", themeColor: "#FF1493",
            days: { segunda: [], terca: [], quarta: [], quinta: [], sexta: [], sabado: [] } 
        };

        let isSaved = true;

        async function processFile(input, type) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = async (e) => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const size = 120; // Tamanho compacto para o link n√£o quebrar
                    canvas.width = size; canvas.height = size;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, size, size);
                    const compressed = canvas.toDataURL('image/jpeg', 0.6);
                    if(type === 'prof') workoutData.photoProf = compressed;
                    else workoutData.photoStudent = compressed;
                    applyConfigs(); render(); markUnsaved(); saveDraft();
                };
            };
            reader.readAsDataURL(file);
        }

        async function getShortUrl(longUrl) {
            try {
                const res = await fetch(`https://is.gd/create.php?format=json&url=${encodeURIComponent(longUrl)}`);
                const data = await res.json();
                if(data.shorturl) return data.shorturl;
                throw new Error("isgd_limit");
            } catch (e) {
                try {
                    const res2 = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`);
                    const data2 = await res2.text();
                    return data2.includes("http") ? data2 : longUrl;
                } catch (e2) { return longUrl; }
            }
        }

        function init() {
            renderLibrary();
            const urlParams = new URLSearchParams(window.location.search);
            const alunoData = urlParams.get('aluno');
            if (alunoData) {
                try {
                    const decoded = decodeURIComponent(atob(alunoData).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
                    workoutData = JSON.parse(decoded);
                    document.body.classList.add('is-student-mode');
                    document.getElementById('progressContainer').classList.remove('hidden');
                } catch(e) { loadDraft(); }
            } else { loadDraft(); renderHistory(); }
            applyConfigs();
            render();
        }

        function applyConfigs() {
            document.documentElement.style.setProperty('--main-color', workoutData.themeColor);
            document.getElementById('brandName').innerText = workoutData.profName;
            document.getElementById('confName').value = workoutData.profName;
            document.getElementById('confPhone').value = workoutData.profPhone;
            document.getElementById('themeColor').value = workoutData.themeColor;
            document.getElementById('displayImgProf').src = workoutData.photoProf || "https://zeus-rr.github.io/treino/icon.png";
            document.getElementById('waPhoto').src = workoutData.photoProf || "https://zeus-rr.github.io/treino/icon.png";
            const firstName = workoutData.profName.split(' ')[0];
            document.getElementById('waText').innerText = `D√∫vida com ${firstName}`;
            document.getElementById('waFloat').href = `https://api.whatsapp.com/send?phone=${workoutData.profPhone}&text=Ol√° ${firstName}, preciso de ajuda!`;
        }

        async function generateLink() {
            const btn = document.getElementById('btnLink');
            btn.classList.add('btn-loading');
            btn.innerHTML = `<span class="loader"></span> ENCURTANDO...`;
            const url = await getShortUrl(getFullURL());
            navigator.clipboard.writeText(url);
            btn.innerText = "COPIADO! ‚úÖ";
            setTimeout(() => {
                btn.classList.remove('btn-loading');
                btn.innerText = "COPIAR LINK üîó";
            }, 2000);
            markSaved();
        }

        async function sendWhatsApp() {
            const btn = document.getElementById('btnWA');
            btn.classList.add('btn-loading');
            btn.innerHTML = `<span class="loader"></span> GERANDO...`;
            const url = await getShortUrl(getFullURL());
            btn.classList.remove('btn-loading');
            btn.innerText = "ENVIAR WHATSAPP üì±";
            window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent('Seu plano de treino atualizado: ' + url)}`, '_blank');
            markSaved();
        }

        function updateHeader() { 
            workoutData.student = document.getElementById('studentName').value; 
            render(); saveDraft(); 
        }

        function render() {
            const container = document.getElementById('weekDisplay');
            const headerTop = document.getElementById('studentHeaderTop');
            container.innerHTML = "";
            const isStudent = document.body.classList.contains('is-student-mode');
            
            document.getElementById('studentName').value = workoutData.student || "";
            document.getElementById('generalNotes').value = workoutData.generalNotes || "";

            if (workoutData.student) {
                headerTop.classList.remove('hidden');
                headerTop.innerHTML = `
                    ${workoutData.photoStudent ? `<img src="${workoutData.photoStudent}" class="student-photo-large">` : ''}
                    <h2 class="text-3xl font-black uppercase italic pink-bold">${workoutData.student}</h2>
                `;
            } else { headerTop.classList.add('hidden'); }

            Object.keys(workoutData.days).forEach(dayKey => {
                if (workoutData.days[dayKey].length === 0) return;
                let html = `<div class="day-section">
                    <h2 class="text-xl font-black uppercase italic pink-bold mb-4 border-l-4 border-pink-hot pl-3">${dayKey}</h2>
                    <div class="grid gap-3">`;
                
                workoutData.days[dayKey].forEach((ex, idx) => {
                    let numSeries = parseInt(ex.r.split('x')[0]) || 0;
                    let checklist = isStudent && numSeries > 0 ? `<div class="flex gap-2 mt-3 flex-wrap">${Array.from({length:numSeries}, (_,i)=>`<div class="serie-dot" onclick="toggleCheck(this)">${i+1}</div>`).join('')}</div>` : "";

                    html += `
                    <div class="bg-white dark:bg-slate-900 p-4 rounded-[1.5rem] border border-slate-200 shadow-sm">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <div class="drag-handle admin-ui">‚ò∞</div>
                                <div>
                                    <h4 class="font-bold text-xs uppercase">${ex.n}</h4>
                                    <input type="text" value="${ex.obs}" oninput="workoutData.days['${dayKey}'][${idx}].obs=this.value;markUnsaved()" class="bg-transparent text-[10px] w-full outline-none" placeholder="Obs...">
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <div class="text-center">
                                    <p class="text-[8px] opacity-50 font-bold">S√âRIES</p>
                                    <input type="text" value="${ex.r}" oninput="workoutData.days['${dayKey}'][${idx}].r=this.value" class="w-12 bg-slate-100 dark:bg-slate-800 text-center text-[10px] p-2 rounded-lg font-bold">
                                </div>
                                <button onclick="removeEx('${dayKey}', ${idx})" class="admin-ui text-red-500 px-1 self-end mb-1">‚úï</button>
                            </div>
                        </div>
                        ${checklist}
                    </div>`;
                });
                container.innerHTML += html + `</div></div>`;
            });
        }

        function toggleCheck(el) {
            el.classList.toggle('checked');
            const pct = (document.querySelectorAll('.serie-dot.checked').length / document.querySelectorAll('.serie-dot').length) * 100;
            document.getElementById('progressFill').style.width = pct + '%';
            if(pct === 100) document.getElementById('finishArea').classList.remove('hidden');
        }

        function renderLibrary() {
            const container = document.getElementById('accordionLib');
            container.innerHTML = Object.keys(exerciseLibrary).map(cat => `
                <div class="border border-slate-100 dark:border-slate-800 rounded-xl overflow-hidden mb-2">
                    <button onclick="this.nextElementSibling.classList.toggle('active')" class="w-full p-3 text-left bg-slate-50 dark:bg-slate-800 text-[10px] font-black uppercase flex justify-between items-center">
                        ${cat} <span>‚ñº</span>
                    </button>
                    <div class="category-content p-2 space-y-1">
                        ${exerciseLibrary[cat].map(ex => `<div onclick="addEx('${ex}', this)" class="p-2 text-[11px] hover:bg-slate-100 dark:hover:bg-slate-700 cursor-pointer rounded-lg transition-all duration-200">${ex}</div>`).join('')}
                    </div>
                </div>`).join('');
        }

        function addEx(name, el) {
            workoutData.days[document.getElementById('daySelector').value].push({ n: name, r: "3x12", w: "", obs: "", bi: false });
            el.classList.add('bg-green-500', 'text-white'); setTimeout(() => el.classList.remove('bg-green-500', 'text-white'), 300);
            markUnsaved(); render(); saveDraft();
        }

        function getFullURL() {
            const json = JSON.stringify(workoutData);
            const enc = btoa(encodeURIComponent(json).replace(/%([0-9A-F]{2})/g, (m, p) => String.fromCharCode('0x' + p)));
            return `${window.location.origin}${window.location.pathname}?aluno=${enc}`;
        }

        function updateConfigs() { workoutData.profName = document.getElementById('confName').value; workoutData.profPhone = document.getElementById('confPhone').value; workoutData.themeColor = document.getElementById('themeColor').value; applyConfigs(); saveDraft(); }
        function saveDraft() { localStorage.setItem('jaque_draft_v2', JSON.stringify(workoutData)); }
        function loadDraft() { const s = localStorage.getItem('jaque_draft_v2'); if(s) workoutData = JSON.parse(s); }
        function markUnsaved() { isSaved = false; document.getElementById('saveStatus').innerText = "N√ÉO SALVO"; }
        function markSaved() { isSaved = true; document.getElementById('saveStatus').innerText = "SALVO"; }
        function checkAndExecute(cb) { if(!isSaved && !confirm("N√£o salvo. Continuar?")) return; cb(); }
        function removeEx(d, i) { workoutData.days[d].splice(i, 1); render(); markUnsaved(); }
        function toggleTheme() { document.documentElement.classList.toggle('dark'); }
        function filterLibrary() { const q = document.getElementById('searchEx').value.toLowerCase(); document.querySelectorAll('#accordionLib .category-content div').forEach(i => i.style.display = i.innerText.toLowerCase().includes(q) ? 'block' : 'none'); }
        function clearCurrentWork() { if(confirm("Limpar tela?")) { workoutData.days = { segunda: [], terca: [], quarta: [], quinta: [], sexta: [], sabado: [] }; render(); } }
        function saveToHistory() { if(!workoutData.student) return alert("Nome do aluno!"); let history = JSON.parse(localStorage.getItem('jaque_history_v2') || '[]'); history.unshift({ id: Date.now(), name: workoutData.student, date: new Date().toLocaleDateString(), data: JSON.parse(JSON.stringify(workoutData)) }); localStorage.setItem('jaque_history_v2', JSON.stringify(history)); markSaved(); renderHistory(); alert("Salvo!"); }
        function renderHistory() { const list = document.getElementById('historyList'); let history = JSON.parse(localStorage.getItem('jaque_history_v2') || '[]'); list.innerHTML = history.map(item => `<div class="flex justify-between items-center bg-slate-50 dark:bg-slate-800 p-2 rounded-lg text-[10px] font-bold mb-1 border"><div class="cursor-pointer" onclick="loadHistoryItem(${item.id})">${item.name}</div><button onclick="deleteHistoryItem(${item.id})" class="text-red-500">‚úï</button></div>`).join(''); }
        function loadHistoryItem(id) { let history = JSON.parse(localStorage.getItem('jaque_history_v2') || '[]'); const item = history.find(i => i.id === id); if(item) { workoutData = JSON.parse(JSON.stringify(item.data)); applyConfigs(); render(); markSaved(); } }
        function deleteHistoryItem(id) { let history = JSON.parse(localStorage.getItem('jaque_history_v2') || '[]'); localStorage.setItem('jaque_history_v2', JSON.stringify(history.filter(i => i.id !== id))); renderHistory(); }
        
        window.onload = init;
    </script>
</body>
</html>
